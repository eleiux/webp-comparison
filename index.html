<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.webp image comparisons</title>
    <style>
        h4{
            font-family:Arial;
            text-align:center;
        }
        table{
            margin:auto;
            padding:0px;
            border-spacing: 0;
            border-collapse: collapse;
        }
        table img{
            display:block;
            max-height:250px;
            margin:auto;
          
        }
        td, th{
            text-align: center;  
            font-family:Arial;
            border-collapse: collapse;
        }
        tr:not(:first-of-type){
            height:250px;
        }
        td:not(:nth-of-type(2)), th{
            padding:10px;
            border:3px solid lightgray;
        }
        button{
            padding:10px;
            border:none;
            cursor:pointer;
            background-color:lightgray;
            border-radius:10px;
        }
        #donut-stats{
            display:flex;
            align-items:center;
            justify-content: center; 
            width:600px;
            margin: auto;
            padding-top:40px;
        }
        #donut-text{
            font-family:Arial;
            text-align:center;
            transform:translateY(-250px);
        }
        .cent-content{
            text-align:center; font-family:Arial; padding:40px; width:90%; display:block;
            margin:auto;
        }
    </style>
    <script type="importmap">
    {
      "imports": {
        "d3": "https://cdn.jsdelivr.net/npm/d3@7.9.0/+esm"
      }
    }
    </script>
</head>
<body>
    <h4>A simple list of how image sizes change when converting to webp. For a small project to help a minecraft server I play on (svanilla - IP: <a href="corn.gg">corn.gg</a>)</h4>
    <table>
        <th>Title</th><th width="fit-content">Image</th><th>Size Before</th><th>Size After</th><th>Percentage Saved</th>
        <tr>
            <td>
                <p>bg1</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg1.webp">
            </td>
            <td>
                <p>4524 KB</p>
            </td>
            <td>
                <p>913 KB</p>
            </td>
            <td>
                <p>79.9%</p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg3</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg3.webp">
            </td>
            <td>
                <p>3617 KB</p>
            </td>
            <td>
                <p>570 KB</p>
            </td>
            <td>
                <p>84.24%</p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg4</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg4.webp">
            </td>
            <td>
                <p>18927 KB</p>
            </td>
            <td>
                <p>4083 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg5</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg5.webp">
            </td>
            <td>
                <p>13041 KB</p>
            </td>
            <td>
                <p>1080 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg6</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg6.webp">
            </td>
            <td>
                <p>8222 KB</p>
            </td>
            <td>
                <p>1111 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg7</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg7.webp">
            </td>
            <td>
                <p>10156 KB</p>
            </td>
            <td>
                <p>1296 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg8</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg8.webp">
            </td>
            <td>
                <p>10185 KB</p>
            </td>
            <td>
                <p>1359 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg9</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg9.webp">
            </td>
            <td>
                <p>11141 KB</p>
            </td>
            <td>
                <p>1745 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg10</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg10.webp">
            </td>
            <td>
                <p>11334 KB</p>
            </td>
            <td>
                <p>1462 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg11</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg11.webp">
            </td>
            <td>
                <p>11308 KB</p>
            </td>
            <td>
                <p>1588 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg12</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg12.webp">
            </td>
            <td>
                <p>10890 KB</p>
            </td>
            <td>
                <p>1735 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg13</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg13.webp">
            </td>
            <td>
                <p>11728 KB</p>
            </td>
            <td>
                <p>2132 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg14</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg14.webp">
            </td>
            <td>
                <p>10882 KB</p>
            </td>
            <td>
                <p>1669 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg15</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg15.webp">
            </td>
            <td>
                <p>781 KB</p>
            </td>
            <td>
                <p>485 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg16</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg16.webp">
            </td>
            <td>
                <p>2533 KB</p>
            </td>
            <td>
                <p>609 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg17</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg17.webp">
            </td>
            <td>
                <p>12524 KB</p>
            </td>
            <td>
                <p>901 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg18</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg18.webp">
            </td>
            <td>
                <p>3631 KB</p>
            </td>
            <td>
                <p>788 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
         <tr>
            <td>
                <p>bg19</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg19.webp">
            </td>
            <td>
                <p>4035 KB</p>
            </td>
            <td>
                <p>790 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg20</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg20.webp">
            </td>
            <td>
                <p>1505 KB</p>
            </td>
            <td>
                <p>353 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg21</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg21.webp">
            </td>
            <td>
                <p>3548 KB</p>
            </td>
            <td>
                <p>1883 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg22</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg22.webp">
            </td>
            <td>
                <p>2901 KB</p>
            </td>
            <td>
                <p>572 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg23</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg23.webp">
            </td>
            <td>
                <p>2081 KB</p>
            </td>
            <td>
                <p>1041 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
        <tr>
            <td>
                <p>bg24</p>
            </td>
            <td>
                <img src="webp-backgrounds/bg24.webp">
            </td>
            <td>
                <p>5381 KB</p>
            </td>
            <td>
                <p>729 KB</p>
            </td>
            <td>
                <p></p>
            </td>
        </tr>
    </table>
    <br id="land-on">
    <div id="donut-stats">
        <!--dynamically injected with d3 script-->
    </div>

    

    <div class="cent-content">
        <a style="font-size:25px;" href="https://github.com/eleiux/webp-comparison/tree/main/webp-backgrounds">Content on github: https://github.com/eleiux/webp-comparison/tree/main/webp-backgrounds</a>
        <p>if you don't want to download, paste "https://pub-d5248ecedccf4da6ad39e4b0750001ba.r2.dev/webp-backgrounds/FILENAME.webp" into wherever your images go, where files are kept on Cloudflare's R2 Public Storage.</p>
        <button id="download-bg-zip">Download All images from here (ZIP)</button>
    </div>



<!-- Include JSZip from CDN -->
<script src="https://cdn.jsdelivr.net/npm/jszip@3/dist/jszip.min.js"></script>

<script>//JSZip content
  document.getElementById('download-bg-zip').addEventListener('click', async () => {
    const zip = new JSZip();
    const baseURL = 'https://eleiux.github.io/webp-comparison/webp-backgrounds/';
    const files = [
      'bg1.webp','bg3.webp','bg4.webp','bg5.webp','bg6.webp','bg7.webp','bg8.webp','bg9.webp',
      'bg10.webp','bg11.webp','bg12.webp','bg13.webp','bg14.webp','bg15.webp','bg16.webp',
      'bg17.webp','bg18.webp','bg19.webp','bg20.webp','bg21.webp','bg22.webp','bg23.webp','bg24.webp'
    ];

    // Fetch each image and add to the zip
    for (const name of files) {
      try {
        const res = await fetch(baseURL + name);
        if (!res.ok) throw new Error(`HTTP ${res.status}`);
        const blob = await res.blob();
        zip.file(name, blob);
      } catch (err) {
        console.error(`Failed to fetch ${name}:`, err);
      }
    }

    // Generate the zip and trigger download
    try {
      const content = await zip.generateAsync({ type: 'blob' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(content);
      a.download = 'webp-backgrounds.zip';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      // cleanup
      URL.revokeObjectURL(a.href);
    } catch (err) {
      console.error('Could not generate zip:', err);
    }
  });
</script>

    
<script>//downloads for each individual item in the first column
document.addEventListener('DOMContentLoaded', () => {
  const baseUrl = 'https://eleiux.github.io/webp-comparison/webp-backgrounds/';
  const table = document.querySelector('table');
  if (!table) return;

  table.querySelectorAll('tr').forEach(row => {
    const cells = row.querySelectorAll('td');
    if (cells.length === 0) return;

    // first <td> contains a placeholder like "bg15"
    const placeholder = cells[0].textContent.trim();
    if (!/^bg\d+$/.test(placeholder)) return;

    const filename = placeholder + '.webp';

    // create download button
    const btn = document.createElement('button');
    btn.textContent = `${placeholder} ⭳`;
    btn.addEventListener('click', async () => {
      try {
        // fetch the image as a blob
        const res = await fetch(baseUrl + filename);
        if (!res.ok) throw new Error(res.statusText);
        const blob = await res.blob();

        // create a blob URL and trigger download
        const blobUrl = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = blobUrl;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(blobUrl);
      } catch (err) {
        console.error('Download failed for', filename, err);
      }
    });

    // replace the placeholder text with the button
    cells[0].textContent = '';
    cells[0].appendChild(btn);
  });
});
</script>





    <script>//parsing the averages in fifth column
                // Grab each row that has at least 5 <td>s and pull out the raw numbers
        function collectRows() {
        const table = document.querySelector('table');
        if (!table) return [];

        return Array.from(table.querySelectorAll('tr'))
            .map(row => {
            const cells = row.querySelectorAll('td');
            if (cells.length < 5) return null;

            const orig    = parseInt(cells[2].textContent.replace(/\D/g, ''), 10);
            const reduced = parseInt(cells[3].textContent.replace(/\D/g, ''), 10);
            return { row, orig, reduced };
            })
            .filter(x => x);
        }

        const rowsData = collectRows();

        // Compute % and inject into the 5th cell’s <p>
        rowsData.forEach(({ row, orig, reduced }) => {
        const pct = ((orig - reduced) / orig) * 100;
        
        const fifthCell = row.querySelectorAll('td')[4];
        let p = fifthCell.querySelector('p');
        if (!p) {
            p = document.createElement('p');
            fifthCell.appendChild(p);
        }
        
        p.textContent = `${pct.toFixed(2)}%`;
        });
    </script>


<script type="module">//for the chart/diagram/donut display on the bottom
  import * as d3 from 'd3';

  // 1) Grab every <p> in the 5th <td> of each row, parse its "%", average them
  const percentNodes = Array.from(
    document.querySelectorAll('table tr td:nth-child(5) p')
  );
  const rawNumbers = percentNodes
    .map(p => parseFloat(p.textContent.replace('%', '')))
    .filter(n => !isNaN(n));
  const avgPct = rawNumbers.reduce((sum, n) => sum + n, 0) / rawNumbers.length;
  const pct = avgPct / 100;  // fraction for the arc

  // Log the average
  console.log(`Average reduction percentage: ${avgPct.toFixed(2)}%`);


  // 2) D3 donut config
  const width = 200;
  const height = 200;
  const radius = Math.min(width, height) / 2;
  const innerRadius = radius * 0.5;
  const outerRadius = radius * 0.8;
  const cornerRadius = 10;

  const svg = d3.select('#donut-stats')
    .append('svg')
      .attr('width', width)
      .attr('height', height)
    .append('g')
      .attr('transform', `translate(${width/2},${height/2})`);

  // background ring
  const bgArc = d3.arc()
    .innerRadius(innerRadius)
    .outerRadius(outerRadius)
    .startAngle(0)
    .endAngle(2 * Math.PI);

  svg.append('path')
    .attr('d', bgArc())
    .attr('fill', '#d3d3d3');

  // foreground arc
  const fgArc = d3.arc()
    .innerRadius(innerRadius)
    .outerRadius(outerRadius)
    .startAngle(0)
    .cornerRadius(cornerRadius);

  const fg = svg.append('path')
    .datum({ endAngle: 0 })
    .attr('fill', '#FFF085')
    .attr('d', fgArc);

  // animate to the true average
  fg.transition()
    .duration(1200)
    .attrTween('d', d => {
      const interpolate = d3.interpolate(d.endAngle, pct * 2 * Math.PI);
      return t => {
        d.endAngle = interpolate(t);
        return fgArc(d);
      };
    });

  // center label shows the rounded average percent
  // 1) define a blur filter
const defs = svg.append('defs');
defs.append('filter')
  .attr('id', 'blur-bg')
  .append('feGaussianBlur')
    .attr('in', 'SourceGraphic')
    .attr('stdDeviation', 3);  // tweak for more/less blur

// 2) append your text
const text = svg.append('text')
  .attr('text-anchor', 'middle')
  .attr('dy', '0.35em')
  .style('font-family', 'Arial')
  .style('font-size', '24px')
  .style('fill', '#000')
  .text(`${avgPct.toFixed(0)}% reduced`);

// 3) measure it
const padding = 5;
const bbox = text.node().getBBox();

// 4) insert a blurred white rect behind, with padding
svg.insert('rect', 'text')
  .attr('x', bbox.x - padding)
  .attr('y', bbox.y - padding)
  .attr('width',  bbox.width + padding * 2)
  .attr('height', bbox.height + padding * 2)
  .style('fill', 'white')
  .style('fill-opacity', 0.6)
  .attr('filter', 'url(#blur-bg)');
</script>




</body>
</html>